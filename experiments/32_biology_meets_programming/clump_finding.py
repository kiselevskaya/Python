

from pattern_count import frequency_map
from pattern_matching import *
import unittest
import os


def clump_finding(genome, k, l, t):
    freq_map = frequency_map(genome, k)
    words = []
    for key in freq_map:
        if freq_map[key] >= t:
            words.append(key)
    output = []
    for pattern in words:
        match = pattern_matching(pattern, genome)
        for i in range(len(match)):
            try:
                last_index_l = i+t-1
                if match[last_index_l]+k-1 <= match[i]+l-1:
                    output.append(pattern)
                    break
            except Exception as e:
                break
    return output


def clump_finding_efficient(genome, k, l, t):
    freq = {}
    n = len(genome)
    for i in range(n-k+1):
        pattern = genome[i:i+k]
        if pattern in freq.keys():
            freq[pattern].append(i)
        else:
            freq[pattern] = [i]
    patterns = []
    for key in freq:
        if len(freq[key]) >= t:
            for j in range(len(freq[key])):
                try:
                    last_index_l = j+t-1
                    if freq[key][last_index_l]+k-1 <= freq[key][j]+l-1:
                        patterns.append(key)
                        break
                except Exception as e:
                    break
    return patterns


class TestClumpFinding(unittest.TestCase):

    def test_clump_finding_0(self):
        genome = 'CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA'
        k, l, t = 5, 50, 4
        a = clump_finding(genome, k, l, t)
        b = ['CGACA', 'GAAGA']
        self.assertCountEqual(a, b)

    def test_clump_finding_1(self):
        genome = 'GCGGTTATGCACCGTTCAAATTAGCAAACCACTAAGCGACGTAGTCTGGATTGATTTCTCCCTACCAGTGACCCAAGACGCGTTAGTGAGTTAAGTTCATATCCAGTACCTGCCGCCCTCTGTACTTGGGCGTCCGATTCGCATGCTTACTCAGGTGGAGGACACGATAATCTGATTAAACTGAGCTAAACCAGGTGGAACCAGAAACCAGGTGGGGAGTCTCGCTTCAAGCCGTTCTTGCGATCAAACCAGGTGGTCCATTATGAAACCAGGTGGCTAAACCAGGTGGTCCAGATCCTCGAATGATGTCGGTGCACATCAAAACCAGGTGGGGTGGTGGAACGTAAAACCAGGTGGCATAAACCAGGTGGGCCGGTTCGTAAACCAGGTGAAACCAGGTGGGGTGGAAACCAGGTGGGTTACAAATTACGTTGAGATGGCCCAAACCAGGTGGTGGGCTTCACCCATGTCAACAAACCACCCTATGGAACTAAACCAGGTGGAACCAGGTGGTGAAGGCTTATCCTCAGGAAAAACCAGGTGGAGGTGGTGAAATAAAACCAGGTGGACCAGGTGGATAACCCTCGCCTCGCTTCTCAACCGAGACCTGGATAAACCAGGTGGGGTGGTCCACCGATTTTTGAGACACTAGAAACCAGGTGGGCGGGGAAACCAGGTGGCAAACCAGGTGGGGTGGACGGAAACCAGGTGGATATGTCATAAAACCAAACCAGGTGGTGCACCCCCATGGTGTGTCTTATCCGTGCGTATAAACCAGGTGGTCGCACGGCTTCCACTTGCTGAGAATAGGCCCGCAGGGTCAGTGCCATGCCCTCCGTCACTCGATATGTGTTGTAAGAGTGGTTACCCCTTCATTGAAGTCGCCCACAGCCCCACCTGCATTGCTAGACTATCACCCTACAGTAGGCCTTTTCGCCTTCTTCAAGCAGCAATCTCTTATCCGCGGATGGGCGCGGCGAGCGTGGCGTCCCCGAACATTTTTACCTAACGTGTTTTGTTGGCCGCAAGCCTTCCCTCTAGTCCACCTCAGCCATTCAGCCTAGTAGCTTTCAAGCCGAGCCTTCCATATCTAATGGACCGTCCAGAATTTCACACGTTTCACAGGGCTGTGTTCGACCGCCCGTAATGCTGTTTCACAGGCGATCGCCTTGCGGTTTTTTCACAGATCGCAGCCGATGGACATGCCAACTCGATTTTCACAGAGTTTTTCACAGCGGTTTCACAGCACAGCAGTGATTGTTTCACAGCAATTTTCACTTTCACAGGGGCCCTTTTCACAGCTCAGGGCTCTTTTCACTTTCACAGTTTCACAGCGCTCCTTTCACAGAGCGGGGAAATTTAAGGGAACACTCAAGGGAACAAGGGAACACACAAAGGGAACACAACACAACACATAAGGGAACACTTTCACAGAACACAAAAGTCCGAAATCATCAGCGGCGAAGGGATTTCACAGACAGACACTTTCACAGCGCATTTCACAGATACGTACTTTCACAGGCGTACTTTCACAGACTTTCACAGAGGACAAGCTCAATTTTCACAGACAGGCTGGATAAATTTCACAGCGGTAAGGGTTTCACAGCACACATAAGGGAACACGAATTTCACAGCAGGGAACACCTCTACGAGTAATCTATTACTCTACCTACTGAAGGGAACACACCGAAGACCTACTATTACCTATTACTCTTAAAGGGAACACATTACAAGGGAACACACTCTCTCGTCATATCTCACCTCTCTATTACTCTTAAGGGAACACCTTCTCGATCAACCTATTACTCTATGGAGATAGAGATATTCCAGACATATGGAGATAACATGGAGATATGGAGATAATGGAGATGGAGATAGCTCTTATATTTATCCTATGGAGATATGATACTATTAATGGAGATAATTCTAATGGAGATATAATTACTCTAAGAGGATGGGATCTCGGGCTATTACTCTAATGGAGATAAGCACTATTACTCTAGGAAATGGAGATATGTCAATGGAGATATGTAATGGAGATAGAGGGAGATGGAGTCGCCATTTCATAATCGCCATTTCATAGTTCAGGAATCGCCATTTCCGCCATTTCTAAGATGGAGTCGCCATTTCTACGTATGGAGATAGGATCGCCATTTCATACGACCCGTTGGATATCGCCATTTCCTCGCCATTTCTGGTGACATTTCTCGCCATTTCATTTCTGGAGATAGATGGATCTCGCCATTTCATAGGAATCGCCATTTCCACGTAGGGGGGGCCACAATCCGTAGGTCGGAATTCAGACTCGCCATTTCCCATCGCCATTTCTTCACCTGTATGCCGATCCCTTCGCCATTTCTCATGGAGATAACTCTCTCTCGCCATTTCTCGCCATTTCCATTTCACTCTCATTCGCCATCGCCATTTCCATTCGCCATTTCATCGCCATTTCTTCAGGATAAGATATCGCCATTTCGACTCTCATTCGCATACTGACTCTCATTCTCATCTCGCCATTTCTCATCTGACTCTCATCCTGGGGGAAACTTGCGACTCTCATCACACTTCCGTCGACTCTCATACTGGCGGATAGCATAGGAGCCATTTAAAGACTCTCATTCTCATTCGAGACTCTCATTCAAATCCTACGAGGACTCTCATATAGACTCTCATATCATTACGAGGACTCTCATATACGAGCCATGCATGTGGCGACGACTCTCATCTACGAGCCATGCAAGCAGAATCTACGAGCGACTCTCATTACGAGCCATGTGACCGTACGAGCCATGCATGCATGCCATGCTGACTCTCATCGAGTACGAGCCATGGAAGTTCTTGTTGGTTCGTAGCCCAAGAGCTGAAGTTACGAGCCTACGAGCCATGAAGTTACTTTTACGAGCCATGAAGCTTACGATACGAGCCATGCGAGCCATGCATCCGCGCTACGAGCCATGTTCCAGTACGAGCCATGTTAGTTGCTGAAGTTAAGTTTGGCGCTGAAGTTTGTACGAGCCATGTGCCCGCTGAAGTTTGTTGTACGAGCCATGCATGCTGAAGTTAATGGCTGAAGTTAGCGTTTGCGGGCAGATCCTCATTCTACGATACGAGCCATGCCATGCAGCTGAAGTTAAGTTGGGTTACGAGCCATGCGAGCCATGTGAAGTACGAGCCATGCTGGCTGAAGTTGTTTGTGCTGCTGAAGTTGCTCTTGTCTCTAGCTGAAGTTGCCAACAGGGCTGAAGCTGAAGTTTAAGCTGAAGTTGCGAGCAGGCTGAAGTTATCGGATTGGGGCTGAAGTTCAACCTCCCGTCCCCCCACACTATATTCCCGTCCCCCCCCGCGCACGCGCCGTCTCCCGTCCCCCCTATCCCGTGCGCACGCGACGCGATCCCGTCCCCCCAGAGTGCGCGCACGCGTCCCCCTTCCCGTCCCCCTCTCCCGGGCGCACGCGTCGCTCAACATTTCCGCGCACGCGTCGCGCACGCGGGCGCACGCGGGTCCCGTCCCCCCCCCTCTTCGGCGCACGCGGAATTCCCGTCGCGCACGCGTCCCGTCCCGCGCACGCGTCGCGCACGCGACTGCCCTAACCAACAGTGCGCACGCGCCGGTAACCCGGTAACCCGGTAACCGCGCACGCGGGCGCACGCGCGTAACCCGCGCACGCGCCGCGCACGCGGCCCGGTTCCCGTCCCCCCCGGTAACCCGGTAACTCCCGTCCCCCGTAACCCGGTGCGCACGCGCCCGGCGCACGCGGAGCGCACGCGCCCCCCCCGGTAATAGCGCACGCGCCCGGGCGCACGCGCCCGGTAACCCGGTAACCCGGGCGCGCGCACGCGGCGGCGCACGCGGCGCACGCGGCGCACGCG'
        k, l, t = 11, 566, 18
        a = clump_finding(genome, k, l, t)
        b = ['AAACCAGGTGG']
        self.assertCountEqual(a, b)

    def test_clump_finding_2(self):
        genome = 'CCCGGACTTCCCCAAAAGTCCAACAGGGCGAGAACCGATTCGTCTTAAATCAAAAAATCCAAAAAACAGAACCGTACCTCGGTTTTTCACAATGTACTCGGGTCTAACTATAGGTCCAAACCGTGTATTCATGTCGGTTAGTCCATCGTGATGTTTGGTTCACTGTCTGCACTGCCCGAATCCAGCGGGCCCCTCTTCCGTCACGCTAATGTACGGGGGACAGTCCCGTTGGCGCTTTTTTAGGACAGTCAGTGGGATTGGGCAGTGGGATCTAGCGCGAACCTGCCAGAAAAGACCTTGCAGACGCGTTCGTCCGAGGAGCCACTAAGATTGACACCATGGTGGGCCCTGATTGACCTGGATATCGAATGTAGCCTGATCTGACCTGATCTGAGCGGGCACTTTGAGCACTTAATTTTTGGCCGACGGTTCCCACGCACGTCACCCACGACACCCCACTTATACTTGCTGTCGCGCGTCGAGATGACTCTGCGGGCGGTGCACTCTGCGGCAAACTGTACGGAACAGAGAACCACTCCTTCTTCCAGCGCCGTAAGCCGTAGCCGTAAACCAAATATACCAAGCCGGGTGCCCCTGCAGAGGCACACATCTGTTGTACTCGAGACAACTCGAGACAACAGACAAACGACGCCACCGTGGGATATCACCCATACCACTAGGGATAAAAGGAGTTCCTGATCCACGAATCATGACAGTGTCCATTTGATTGTATAATTTAACTGGCAGGTTGCGCCGTTTGGCAACATGACCACTCCGACGATTTCCTAGGAAAAAGCTCCTGGCAGCCTGTTTGGGACTTTAGTATTTTTAACGGCCAAGGCACGTTAGTGTTGGATTAGCTCTTTCAGCATCCTGAGGTCGGGGATCATCGATGCCCCAGCAGATGTTACTCGTGGCGGGAAAAGAGCACTTACACAGCCGGGCAGCCTGTCCGAGACGGCTTGAACGCCAGAAAGGGACCGTGTTATACTTGAAAGAAGGTTATCAGAACAAAGCGTAGACATCGAGGGGTAGAGGTTCGGAGTGCTGGCGAGGCAACCGTGGAGGAAGCCTAGGGACTGGAAGCAAATCTAGCATTCTGCTCTTGTGGTGTCTCGGCATAGGTCATATCGCTGGCTAAATGTAGACGCCACGAAGATTCAAACTCACAAGGAATTAGTTCGTGACGTAAGCGCTTCTGGGCCTGTGAATTTTAGCGATTCGGACGAATATAGTTCGATTATCGCTTCCTCACTTCCGTCTCTGGGGCGTCGAACCGGCATCCCGCCTTACAGATGGTCCGCGAACGCAGTTGCCTGGGAGGCTTCTAGGCTTGAGGCTTCTAACCACCACTCATATTCTATAACCGAGGATAACATTTTTTGCTTCGAGTTTCGAGGTATAGTAATATAATATCGCTTTCAATATCGCTTAACATATAAAAGGGGCTATTGTCGTCGTAATTCCAGGTCGCGTTTGGTCGCGTTCCTCGTTGGAAAGTATCACGCAAATTTACCGTAGTTCAGGTTGCGAAGAAAGTCGTGACGATGTGAGCCGCCCGTTTAACAAAGGCTGAATCTGGAACCAAGTGTAGCTCCCCACTTATGACGTTAAGTTAAGGAGACGGGACCCCCTGATAAGTGTATCGCGTGATTTAAGCTTGTGAGACTACTCCCCGCAAACTTGGTGTTGGAGTAACTCATGACGCCGTAATCCTTTGCCTGCCCCCCGATGCGCAAAATGCGCAAAATGCGCAAAATGCGCAAAATGCGCAAAATGCGCAAA'
        k, l, t = 9, 29, 3
        a = clump_finding(genome, k, l, t)
        b = ['ATGCGCAAA', 'TGCGCAAAA', 'GCGCAAAAT', 'CGCAAAATG', 'GCAAAATGC', 'CAAAATGCG', 'AAAATGCGC', 'AAATGCGCA', 'AATGCGCAA']
        self.assertCountEqual(a, b)

    def test_clump_finding_efficient_0(self):
        genome = 'CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA'
        k, l, t = 5, 50, 4
        a = clump_finding(genome, k, l, t)
        b = ['CGACA', 'GAAGA']
        self.assertCountEqual(a, b)

    def test_clump_finding_efficient_1(self):
        genome = 'GCGGTTATGCACCGTTCAAATTAGCAAACCACTAAGCGACGTAGTCTGGATTGATTTCTCCCTACCAGTGACCCAAGACGCGTTAGTGAGTTAAGTTCATATCCAGTACCTGCCGCCCTCTGTACTTGGGCGTCCGATTCGCATGCTTACTCAGGTGGAGGACACGATAATCTGATTAAACTGAGCTAAACCAGGTGGAACCAGAAACCAGGTGGGGAGTCTCGCTTCAAGCCGTTCTTGCGATCAAACCAGGTGGTCCATTATGAAACCAGGTGGCTAAACCAGGTGGTCCAGATCCTCGAATGATGTCGGTGCACATCAAAACCAGGTGGGGTGGTGGAACGTAAAACCAGGTGGCATAAACCAGGTGGGCCGGTTCGTAAACCAGGTGAAACCAGGTGGGGTGGAAACCAGGTGGGTTACAAATTACGTTGAGATGGCCCAAACCAGGTGGTGGGCTTCACCCATGTCAACAAACCACCCTATGGAACTAAACCAGGTGGAACCAGGTGGTGAAGGCTTATCCTCAGGAAAAACCAGGTGGAGGTGGTGAAATAAAACCAGGTGGACCAGGTGGATAACCCTCGCCTCGCTTCTCAACCGAGACCTGGATAAACCAGGTGGGGTGGTCCACCGATTTTTGAGACACTAGAAACCAGGTGGGCGGGGAAACCAGGTGGCAAACCAGGTGGGGTGGACGGAAACCAGGTGGATATGTCATAAAACCAAACCAGGTGGTGCACCCCCATGGTGTGTCTTATCCGTGCGTATAAACCAGGTGGTCGCACGGCTTCCACTTGCTGAGAATAGGCCCGCAGGGTCAGTGCCATGCCCTCCGTCACTCGATATGTGTTGTAAGAGTGGTTACCCCTTCATTGAAGTCGCCCACAGCCCCACCTGCATTGCTAGACTATCACCCTACAGTAGGCCTTTTCGCCTTCTTCAAGCAGCAATCTCTTATCCGCGGATGGGCGCGGCGAGCGTGGCGTCCCCGAACATTTTTACCTAACGTGTTTTGTTGGCCGCAAGCCTTCCCTCTAGTCCACCTCAGCCATTCAGCCTAGTAGCTTTCAAGCCGAGCCTTCCATATCTAATGGACCGTCCAGAATTTCACACGTTTCACAGGGCTGTGTTCGACCGCCCGTAATGCTGTTTCACAGGCGATCGCCTTGCGGTTTTTTCACAGATCGCAGCCGATGGACATGCCAACTCGATTTTCACAGAGTTTTTCACAGCGGTTTCACAGCACAGCAGTGATTGTTTCACAGCAATTTTCACTTTCACAGGGGCCCTTTTCACAGCTCAGGGCTCTTTTCACTTTCACAGTTTCACAGCGCTCCTTTCACAGAGCGGGGAAATTTAAGGGAACACTCAAGGGAACAAGGGAACACACAAAGGGAACACAACACAACACATAAGGGAACACTTTCACAGAACACAAAAGTCCGAAATCATCAGCGGCGAAGGGATTTCACAGACAGACACTTTCACAGCGCATTTCACAGATACGTACTTTCACAGGCGTACTTTCACAGACTTTCACAGAGGACAAGCTCAATTTTCACAGACAGGCTGGATAAATTTCACAGCGGTAAGGGTTTCACAGCACACATAAGGGAACACGAATTTCACAGCAGGGAACACCTCTACGAGTAATCTATTACTCTACCTACTGAAGGGAACACACCGAAGACCTACTATTACCTATTACTCTTAAAGGGAACACATTACAAGGGAACACACTCTCTCGTCATATCTCACCTCTCTATTACTCTTAAGGGAACACCTTCTCGATCAACCTATTACTCTATGGAGATAGAGATATTCCAGACATATGGAGATAACATGGAGATATGGAGATAATGGAGATGGAGATAGCTCTTATATTTATCCTATGGAGATATGATACTATTAATGGAGATAATTCTAATGGAGATATAATTACTCTAAGAGGATGGGATCTCGGGCTATTACTCTAATGGAGATAAGCACTATTACTCTAGGAAATGGAGATATGTCAATGGAGATATGTAATGGAGATAGAGGGAGATGGAGTCGCCATTTCATAATCGCCATTTCATAGTTCAGGAATCGCCATTTCCGCCATTTCTAAGATGGAGTCGCCATTTCTACGTATGGAGATAGGATCGCCATTTCATACGACCCGTTGGATATCGCCATTTCCTCGCCATTTCTGGTGACATTTCTCGCCATTTCATTTCTGGAGATAGATGGATCTCGCCATTTCATAGGAATCGCCATTTCCACGTAGGGGGGGCCACAATCCGTAGGTCGGAATTCAGACTCGCCATTTCCCATCGCCATTTCTTCACCTGTATGCCGATCCCTTCGCCATTTCTCATGGAGATAACTCTCTCTCGCCATTTCTCGCCATTTCCATTTCACTCTCATTCGCCATCGCCATTTCCATTCGCCATTTCATCGCCATTTCTTCAGGATAAGATATCGCCATTTCGACTCTCATTCGCATACTGACTCTCATTCTCATCTCGCCATTTCTCATCTGACTCTCATCCTGGGGGAAACTTGCGACTCTCATCACACTTCCGTCGACTCTCATACTGGCGGATAGCATAGGAGCCATTTAAAGACTCTCATTCTCATTCGAGACTCTCATTCAAATCCTACGAGGACTCTCATATAGACTCTCATATCATTACGAGGACTCTCATATACGAGCCATGCATGTGGCGACGACTCTCATCTACGAGCCATGCAAGCAGAATCTACGAGCGACTCTCATTACGAGCCATGTGACCGTACGAGCCATGCATGCATGCCATGCTGACTCTCATCGAGTACGAGCCATGGAAGTTCTTGTTGGTTCGTAGCCCAAGAGCTGAAGTTACGAGCCTACGAGCCATGAAGTTACTTTTACGAGCCATGAAGCTTACGATACGAGCCATGCGAGCCATGCATCCGCGCTACGAGCCATGTTCCAGTACGAGCCATGTTAGTTGCTGAAGTTAAGTTTGGCGCTGAAGTTTGTACGAGCCATGTGCCCGCTGAAGTTTGTTGTACGAGCCATGCATGCTGAAGTTAATGGCTGAAGTTAGCGTTTGCGGGCAGATCCTCATTCTACGATACGAGCCATGCCATGCAGCTGAAGTTAAGTTGGGTTACGAGCCATGCGAGCCATGTGAAGTACGAGCCATGCTGGCTGAAGTTGTTTGTGCTGCTGAAGTTGCTCTTGTCTCTAGCTGAAGTTGCCAACAGGGCTGAAGCTGAAGTTTAAGCTGAAGTTGCGAGCAGGCTGAAGTTATCGGATTGGGGCTGAAGTTCAACCTCCCGTCCCCCCACACTATATTCCCGTCCCCCCCCGCGCACGCGCCGTCTCCCGTCCCCCCTATCCCGTGCGCACGCGACGCGATCCCGTCCCCCCAGAGTGCGCGCACGCGTCCCCCTTCCCGTCCCCCTCTCCCGGGCGCACGCGTCGCTCAACATTTCCGCGCACGCGTCGCGCACGCGGGCGCACGCGGGTCCCGTCCCCCCCCCTCTTCGGCGCACGCGGAATTCCCGTCGCGCACGCGTCCCGTCCCGCGCACGCGTCGCGCACGCGACTGCCCTAACCAACAGTGCGCACGCGCCGGTAACCCGGTAACCCGGTAACCGCGCACGCGGGCGCACGCGCGTAACCCGCGCACGCGCCGCGCACGCGGCCCGGTTCCCGTCCCCCCCGGTAACCCGGTAACTCCCGTCCCCCGTAACCCGGTGCGCACGCGCCCGGCGCACGCGGAGCGCACGCGCCCCCCCCGGTAATAGCGCACGCGCCCGGGCGCACGCGCCCGGTAACCCGGTAACCCGGGCGCGCGCACGCGGCGGCGCACGCGGCGCACGCGGCGCACGCG'
        k, l, t = 11, 566, 18
        a = clump_finding(genome, k, l, t)
        b = ['AAACCAGGTGG']
        self.assertCountEqual(a, b)

    def test_clump_finding_efficient_2(self):
        genome = 'CCCGGACTTCCCCAAAAGTCCAACAGGGCGAGAACCGATTCGTCTTAAATCAAAAAATCCAAAAAACAGAACCGTACCTCGGTTTTTCACAATGTACTCGGGTCTAACTATAGGTCCAAACCGTGTATTCATGTCGGTTAGTCCATCGTGATGTTTGGTTCACTGTCTGCACTGCCCGAATCCAGCGGGCCCCTCTTCCGTCACGCTAATGTACGGGGGACAGTCCCGTTGGCGCTTTTTTAGGACAGTCAGTGGGATTGGGCAGTGGGATCTAGCGCGAACCTGCCAGAAAAGACCTTGCAGACGCGTTCGTCCGAGGAGCCACTAAGATTGACACCATGGTGGGCCCTGATTGACCTGGATATCGAATGTAGCCTGATCTGACCTGATCTGAGCGGGCACTTTGAGCACTTAATTTTTGGCCGACGGTTCCCACGCACGTCACCCACGACACCCCACTTATACTTGCTGTCGCGCGTCGAGATGACTCTGCGGGCGGTGCACTCTGCGGCAAACTGTACGGAACAGAGAACCACTCCTTCTTCCAGCGCCGTAAGCCGTAGCCGTAAACCAAATATACCAAGCCGGGTGCCCCTGCAGAGGCACACATCTGTTGTACTCGAGACAACTCGAGACAACAGACAAACGACGCCACCGTGGGATATCACCCATACCACTAGGGATAAAAGGAGTTCCTGATCCACGAATCATGACAGTGTCCATTTGATTGTATAATTTAACTGGCAGGTTGCGCCGTTTGGCAACATGACCACTCCGACGATTTCCTAGGAAAAAGCTCCTGGCAGCCTGTTTGGGACTTTAGTATTTTTAACGGCCAAGGCACGTTAGTGTTGGATTAGCTCTTTCAGCATCCTGAGGTCGGGGATCATCGATGCCCCAGCAGATGTTACTCGTGGCGGGAAAAGAGCACTTACACAGCCGGGCAGCCTGTCCGAGACGGCTTGAACGCCAGAAAGGGACCGTGTTATACTTGAAAGAAGGTTATCAGAACAAAGCGTAGACATCGAGGGGTAGAGGTTCGGAGTGCTGGCGAGGCAACCGTGGAGGAAGCCTAGGGACTGGAAGCAAATCTAGCATTCTGCTCTTGTGGTGTCTCGGCATAGGTCATATCGCTGGCTAAATGTAGACGCCACGAAGATTCAAACTCACAAGGAATTAGTTCGTGACGTAAGCGCTTCTGGGCCTGTGAATTTTAGCGATTCGGACGAATATAGTTCGATTATCGCTTCCTCACTTCCGTCTCTGGGGCGTCGAACCGGCATCCCGCCTTACAGATGGTCCGCGAACGCAGTTGCCTGGGAGGCTTCTAGGCTTGAGGCTTCTAACCACCACTCATATTCTATAACCGAGGATAACATTTTTTGCTTCGAGTTTCGAGGTATAGTAATATAATATCGCTTTCAATATCGCTTAACATATAAAAGGGGCTATTGTCGTCGTAATTCCAGGTCGCGTTTGGTCGCGTTCCTCGTTGGAAAGTATCACGCAAATTTACCGTAGTTCAGGTTGCGAAGAAAGTCGTGACGATGTGAGCCGCCCGTTTAACAAAGGCTGAATCTGGAACCAAGTGTAGCTCCCCACTTATGACGTTAAGTTAAGGAGACGGGACCCCCTGATAAGTGTATCGCGTGATTTAAGCTTGTGAGACTACTCCCCGCAAACTTGGTGTTGGAGTAACTCATGACGCCGTAATCCTTTGCCTGCCCCCCGATGCGCAAAATGCGCAAAATGCGCAAAATGCGCAAAATGCGCAAAATGCGCAAA'
        k, l, t = 9, 29, 3
        a = clump_finding(genome, k, l, t)
        b = ['ATGCGCAAA', 'TGCGCAAAA', 'GCGCAAAAT', 'CGCAAAATG', 'GCAAAATGC', 'CAAAATGCG', 'AAAATGCGC', 'AAATGCGCA', 'AATGCGCAA']
        self.assertCountEqual(a, b)

    def test_clump_finding_1_3(self):
        data_dir = os.getcwd()+'\\text_files'
        e_coli = open(data_dir+'\\E_coli.txt', 'r')
        genome = e_coli.readlines()[0]
        e_coli.close()
        k, l, t = 9, 500, 3
        a = len(clump_finding_efficient(genome, k, l, t))
        b = 1904
        self.assertEqual(a, b)


if __name__ == '__main__':
    unittest.main()
